<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kiểm tra đầu vào</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/uikit@3.20.8/dist/css/uikit.min.css"
    />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="stylesheet" href="css/output.css" />
  </head>
  <body>
    <div class="exam1">
      <div class="exam1-header exam1-zoom">
        <div class="flex items-center">
          <img class="mr-2" src="/public/exam/icons/arrow-back.svg" alt="" />
          <p class="text-[28px] font-extrabold text-[#006638]">
            Bài kiểm tra Đọc - Viết
          </p>
        </div>
        <div class="relative flex items-center w-fit">
          <img id="timer-img" src="/public/exam/timer1.png" alt="Timer" />
          <p
            id="timer-text"
            class="text-[28px] font-extrabold text-[#006638] absolute top-1/2 left-[43%] transform -translate-y-1/2"
          >
            00:00
          </p>
        </div>

        <div class="w-full justify-end flex items-center h-full">
          <a class="w-fit" href="/kiem-tra.html">
            <img width="24" src="/public/exam/icons/x-gray.svg" alt="x" />
          </a>
        </div>
      </div>
      <div class="flex flex-1 items-center gap-5 xl:gap-8 px-5 xl:px-8">
        <button
          class="exam1-zoom button-primary btn-animation size-16 flex justify-center items-center button-m bg-[#00b26b]"
          style="border-radius: 100%"
        >
          <img
            class="w-6 mr-1.5 rotate-180"
            src="/public/exam/icons/play-solid.svg"
            alt=""
          />
        </button>
        <div class="flex-1 exam1-content w-full rounded-2xl">
          <!-- Start content 2 -->
          <div class="test3 flex justify-center">
            <div class="exam1-content3 w-200 exam1-height">
              <div class="exam1-zoom flex flex-col h-full">
                <div>
                  <div class="flex items-start gap-6 toggle-trans-container">
                    <div
                      class="text-[32px] font-extrabold text-[#3A3335] flex-1"
                    >
                      Choose the correct answer
                    </div>
                    <div
                      class="toggle-trans flex flex-none cursor-pointer gap-2 w-fit items-center rounded-4xl border justify-center border-[#000000]/20 py-1 pr-1 pl-3"
                    >
                      Dịch
                      <img
                        src="/public/exam1/icons/america.svg"
                        class="size-9 rounded-full"
                        alt=""
                      />
                    </div>
                  </div>

                  <div
                    class="flex items-start gap-6 toggle-trans-container hidden"
                  >
                    <div
                      class="text-[32px] font-extrabold text-[#3A3335] flex-1"
                    >
                      Choose the correct answer vietnamese.
                    </div>
                    <div
                      class="toggle-trans flex flex-none cursor-pointer gap-2 w-fit items-center rounded-4xl border justify-center border-[#000000]/20 py-1 pl-1 pr-3"
                    >
                      <img
                        src="/public/exam1/icons/vietnam.svg"
                        class="size-9 rounded-full"
                        alt=""
                      />
                      Trans
                    </div>
                  </div>
                </div>

                <div id="exam-scroll" class="flex-1 mt-10 pb-1 overflow-y-auto">
                  <div class="flex flex-col mt-6 gap-10">
                    <div>
                      <div class="exam1-content6-sentence">
                        <div>
                          <img
                            class="exam1-content6-img"
                            src="public/exam1/3.2.png"
                            alt=""
                          />
                        </div>
                        <div class="flex-1" style="zoom: 1.2">
                          <p class="exam1-content6-answer mb-6">
                            1. This is helicopter?
                          </p>
                          <div class="flex flex-wrap gap-2">
                            <div class="exam1-content6-variant">is</div>
                            <div class="exam1-content6-variant">fish</div>
                            <div class="exam1-content6-variant">Goldenfish</div>
                            <div class="exam1-content6-variant">the</div>
                            <div class="exam1-content6-variant">freshwater</div>
                            <div class="exam1-content6-variant">a</div>
                          </div>
                        </div>
                      </div>

                      <div class="exam1-content6-result">
                        <div
                          style="order: 9999; flex-shrink: 0"
                          class="exam1-placeholder flex-1 min-h-[70px] opacity-70 pointer-events-none z-40"
                        ></div>
                      </div>
                    </div>
                    <div>
                      <div class="exam1-content6-sentence">
                        <div>
                          <img
                            class="exam1-content6-img"
                            src="public/exam1/3.2.png"
                            alt=""
                          />
                        </div>
                        <div class="flex-1" style="zoom: 1.2">
                          <p class="exam1-content6-answer mb-6">
                            2. This is helicopter?
                          </p>
                          <div class="flex flex-wrap gap-2">
                            <div class="exam1-content6-variant">is</div>
                            <div class="exam1-content6-variant">fish</div>
                            <div class="exam1-content6-variant">Goldenfish</div>
                            <div class="exam1-content6-variant">the</div>
                            <div class="exam1-content6-variant">freshwater</div>
                            <div class="exam1-content6-variant">a</div>
                          </div>
                        </div>
                      </div>

                      <div class="exam1-content6-result">
                        <div
                          style="order: 9999; flex-shrink: 0"
                          class="exam1-placeholder flex-1 min-h-[70px] opacity-70 pointer-events-none z-40"
                        ></div>
                      </div>
                    </div>
                    <div>
                      <div class="exam1-content6-sentence">
                        <div>
                          <img
                            class="exam1-content6-img"
                            src="public/exam1/3.2.png"
                            alt=""
                          />
                        </div>
                        <div class="flex-1" style="zoom: 1.2">
                          <p class="exam1-content6-answer mb-6">
                            3. This is helicopter?
                          </p>
                        </div>
                      </div>

                      <div class="exam1-content6-result">
                        <div class="exam1-content6-variant true">
                          Goldenfish
                        </div>
                        <div class="exam1-content6-variant true">is</div>
                        <div class="exam1-content6-variant true">the</div>
                        <div class="exam1-content6-variant true">a</div>
                        <div class="exam1-content6-variant true">
                          freshwater
                        </div>
                        <div class="exam1-content6-variant true">fish</div>
                      </div>
                    </div>
                    <div>
                      <div class="exam1-content6-sentence">
                        <div>
                          <img
                            class="exam1-content6-img"
                            src="public/exam1/3.2.png"
                            alt=""
                          />
                        </div>
                        <div class="flex-1" style="zoom: 1.2">
                          <p class="exam1-content6-answer mb-6">
                            4. This is helicopter?
                          </p>
                        </div>
                      </div>

                      <div class="exam1-content6-result">
                        <div class="exam1-content6-variant true">
                          Goldenfish
                        </div>
                        <div class="exam1-content6-variant true">is</div>
                        <div class="exam1-content6-variant true">the</div>
                        <div class="exam1-content6-variant true">a</div>
                        <div class="exam1-content6-variant fail">
                          freshwater
                        </div>
                        <div class="exam1-content6-variant fail">fish</div>
                      </div>

                      <div class="exam1-result mt-4">
                        <div class="exam1-result-title">Correct Answer:</div>
                        <div class="exam1-result-content">
                          Goldenfish is the a freshwater fish
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- End content 2 -->
        </div>
        <button
          class="exam1-zoom button-primary btn-animation size-16 flex justify-center items-center button-m bg-[#00b26b]"
          style="border-radius: 100%"
        >
          <img
            class="size-6 ml-1.5"
            src="/public/exam/icons/play-solid.svg"
            alt=""
          />
        </button>
      </div>

      <div class="exam1-footer exam1-zoom">
        <div class="flex items-center gap-2">
          <a href="/kiem-tra-test1.html" class="exam1-footer-num done"
            >Part 1</a
          >
          <a href="/kiem-tra-test2.html" class="exam1-footer-num active"
            >Part 2</a
          >
          <a href="/kiem-tra-test3.html" uk-toggle class="exam1-footer-num"
            >Part 3</a
          >
          <a
            href="/kiem-tra-test4.html"
            uk-toggle
            class="exam1-footer-num fail current"
            >Part 4
          </a>
          <a href="/kiem-tra-test5.html" uk-toggle class="exam1-footer-num true"
            >Part 5
          </a>
          <a href="/kiem-tra-test6.html" class="exam1-footer-num">6</a>
          <a href="/kiem-tra-test7.1.html" class="exam1-footer-num">7.1</a>
          <a href="/kiem-tra-test7.2.html" class="exam1-footer-num">7.2</a>
          <a href="/kiem-tra-test8.html" class="exam1-footer-num">8</a>
          <a href="/kiem-tra-test9.html" class="exam1-footer-num">9</a>
          <a href="/kiem-tra-test10.html" class="exam1-footer-num">10</a>
          <a href="#exam-unfinished" uk-toggle class="">p</a>
          <a href="#exam-submit-early" uk-toggle class="">o</a>
          <a href="#exam-done" uk-toggle class="">p</a>
        </div>
        <a
          href="#exam-exit"
          uk-toggle
          class="button-primary btn-animation w-fit flex justify-center items-center px-5 button-m bg-[#00b26b]"
          style="height: 56px; color: white"
        >
          Nộp bài
        </a>
      </div>
    </div>

    <div id="exam-done" class="uk-flex-top" uk-modal>
      <div
        style="
          height: fit-content;
          width: 760px !important;
          border-radius: 20px;
        "
        class="level-modal uk-modal-dialog space-y-10 uk-modal-body uk-margin-auto-vertical"
      >
        <div class="flex justify-between items-center">
          <p></p>
          <p class="heading-h2 text-[#252525]">Tuyệt vời!</p>
          <button
            type="button"
            onclick="hideModal('exam-done')"
            class="rounded-full flex-justify-center"
            style="background-color: transparent"
          >
            <img src="public/icons/x2.svg" width="40" height="40" />
          </button>
        </div>
        <div>
          <div class="rounded-3xl" style="margin-top: 70px">
            <div class="pb-10 flex-justify-center">
              <p class="my-6 text-center text-[#252525] text-2xl">
                Bạn đã hoàn thành bài Nghe.
              </p>
            </div>
            <div class="flex justify-center">
              <a
                href="kiem-tra2.html"
                class="button-primary btn-animation flex items-center justify-center !w-60 bg-primary-green px-5 grayscale-white button-m"
                style="height: 56px; color: white; background-color: #00b26b"
              >
                Tiếp tục
              </a>
            </div>
            <p class="pt-4 text-center text-lg text-[#252525]/40">
              Tự động chuyển sau <span id="countdown">5</span>s
            </p>
          </div>
        </div>
      </div>
    </div>
    <div id="exam-submit-early" class="uk-flex-top" uk-modal>
      <div
        style="
          height: fit-content;
          width: 760px !important;
          border-radius: 20px;
        "
        class="level-modal uk-modal-dialog space-y-10 uk-modal-body uk-margin-auto-vertical"
      >
        <div class="flex justify-between items-center">
          <p></p>
          <p class="heading-h2 text-[#252525]">Nộp bài sớm</p>
          <button
            type="button"
            onclick="hideModal('exam-submit-early')"
            class="rounded-full flex-justify-center"
            style="background-color: transparent"
          >
            <img src="public/icons/x2.svg" width="40" height="40" />
          </button>
        </div>
        <div>
          <div class="space-y-10 rounded-3xl" style="margin-top: 70px">
            <div class="flex-justify-center">
              <p class="pb-6 text-center text-black text-[28px] font-extrabold">
                Thời gian còn lại: 12 phút 40 giây
              </p>
              <p class="my-6 text-center text-[#252525] text-2xl">
                Vẫn còn thời gian để kiểm tra lại trước khi nộp bài.
                <br />
                Bạn có chắc muốn nộp bài sớm không?
              </p>
            </div>
            <div class="space-y-10">
              <div class="space-x-3 flex items-center">
                <button
                  onclick="hideModal('exam-submit-early')"
                  class="button-primary btn-animation flex-1 w-full flex justify-center items-center px-5 button-m text-black bg-[#D8EDDD]"
                  style="height: 56px"
                >
                  Bài kiểm tra lại bài
                </button>
                <button
                  type="button"
                  uk-toggle="target: #exam-done"
                  class="button-primary flex-1 btn-animation w-full flex-center bg-primary-green px-5 grayscale-white button-m"
                  style="height: 56px; color: white; background-color: #00b26b"
                >
                  Nộp bài
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="exam-unfinished" class="uk-flex-top" uk-modal>
      <div
        style="
          height: fit-content;
          width: 760px !important;
          border-radius: 20px;
        "
        class="level-modal uk-modal-dialog space-y-10 uk-modal-body uk-margin-auto-vertical"
      >
        <div class="flex justify-between items-center">
          <p></p>
          <p class="heading-h2 text-[#252525]">Chưa hoàn thành</p>
          <button
            type="button"
            onclick="hideModal('exam-unfinished')"
            class="rounded-full flex-justify-center"
            style="background-color: transparent"
          >
            <img src="public/icons/x2.svg" width="40" height="40" />
          </button>
        </div>
        <div>
          <div class="space-y-10 rounded-3xl" style="margin-top: 70px">
            <div class="flex-justify-center">
              <p class="pb-6 text-center text-black text-[28px] font-extrabold">
                Thời gian còn lại: 12 phút 40 giây
              </p>
              <p class="my-6 text-center text-[#252525] text-2xl">
                Bạn chưa hoàn thành hết bài kiểm tra.
                <br />
                Bạn có chắc muốn nộp bài sớm không?
              </p>
            </div>
            <div class="space-y-10">
              <div class="space-x-3 flex items-center">
                <button
                  onclick="hideModal('exam-unfinished')"
                  class="button-primary btn-animation flex-1 w-full flex justify-center items-center px-5 button-m text-black bg-[#D8EDDD]"
                  style="height: 56px"
                >
                  Tiếp tục làm bài
                </button>
                <button
                  type="button"
                  uk-toggle="target: #exam-done"
                  class="button-primary flex-1 btn-animation w-full flex-center bg-primary-green px-5 grayscale-white button-m"
                  style="height: 56px; color: white; background-color: #00b26b"
                >
                  Nộp bài
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="exam-exit" class="uk-flex-top" uk-modal>
      <div
        style="
          height: fit-content;
          width: 760px !important;
          border-radius: 20px;
        "
        class="level-modal uk-modal-dialog space-y-10 uk-modal-body uk-margin-auto-vertical"
      >
        <div class="flex justify-between items-center">
          <p></p>
          <p class="heading-h2 text-[#252525]">Thoát Bài kiểm tra</p>
          <button
            type="button"
            onclick="hideModal('exam-exit')"
            class="rounded-full flex-justify-center"
            style="background-color: transparent"
          >
            <img src="public/icons/x2.svg" width="40" height="40" />
          </button>
        </div>
        <div>
          <div class="space-y-10 rounded-3xl" style="margin-top: 70px">
            <div class="flex-justify-center">
              <p class="my-6 text-center text-[#252525] text-2xl">
                Sắp hoàn thành rồi bạn ơi! Nếu thoát bây giờ lần tới sẽ phải làm
                lại bài kiểm tra lại từ đầu đó.
              </p>
            </div>
            <div class="space-y-10">
              <div class="space-x-3 flex items-center">
                <a
                  href="/kiem-tra.html"
                  class="button-primary btn-animation flex-1 w-full flex justify-center items-center px-5 button-m bg-[#FF6047]"
                  style="height: 56px; color: white"
                >
                  Vẫn thoát
                </a>
                <button
                  type="button"
                  onclick="hideModal('exam-exit')"
                  class="button-primary flex-1 btn-animation w-full flex-center bg-primary-green px-5 grayscale-white button-m"
                  style="height: 56px; color: white; background-color: #00b26b"
                >
                  Ở lại
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/uikit@3.20.8/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.20.8/dist/js/uikit-icons.min.js"></script>
    <script>
      function hideModal(modalId) {
        const dropdownElement = document.getElementById(modalId);

        UIkit.modal(dropdownElement).hide(0);
      }

      function startCountdown() {
        let timeLeft = 5;
        const countdownElement = document.getElementById("countdown");

        countdownElement.textContent = timeLeft; // Cập nhật lần đầu

        const countdownInterval = setInterval(() => {
          timeLeft--;
          countdownElement.textContent = timeLeft;

          if (timeLeft <= 0) {
            clearInterval(countdownInterval);
            window.location.href = "kiem-tra2.html";
          }
        }, 1000);

        // Lưu interval vào modal để có thể dừng lại khi modal đóng
        document.getElementById("exam-done").dataset.countdown =
          countdownInterval;
      }

      function stopCountdown() {
        const countdownInterval =
          document.getElementById("exam-done").dataset.countdown;
        if (countdownInterval) {
          clearInterval(countdownInterval);
        }
      }

      // Lắng nghe sự kiện mở modal từ UIkit
      UIkit.util.on("#exam-done", "shown", startCountdown);
      UIkit.util.on("#exam-done", "hidden", stopCountdown);
    </script>
    <script>
      function startCountdown(durationInSeconds) {
        let timerElement = document.getElementById("timer-text");
        let timerImage = document.getElementById("timer-img");
        let remainingTime = durationInSeconds;

        function updateTimer() {
          let minutes = Math.floor(remainingTime / 60);
          let seconds = remainingTime % 60;

          // Định dạng số giây thành 2 chữ số (ví dụ: 09 thay vì 9)
          let formattedTime = `${minutes}:${seconds < 10 ? "0" : ""}${seconds}`;
          timerElement.textContent = formattedTime;

          // Thay đổi hình ảnh nếu thời gian còn dưới 1 phút
          if (remainingTime < 60) {
            timerImage.src = "/public/exam/timer2.png";
            timerElement.style.color = "#A21600";
          }

          if (remainingTime > 0) {
            remainingTime--;
            setTimeout(updateTimer, 1000);
          }
        }

        updateTimer();
      }

      // Bắt đầu đếm ngược từ 29 phút 10 giây (tổng cộng 1750 giây)
      window.onload = function () {
        startCountdown(65);
      };
    </script>
    <script src="js/script.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const sentences = document.querySelectorAll(".exam1-content6-sentence");

        sentences.forEach((sentenceContainer) => {
          const originalContainer = sentenceContainer.querySelector(".flex");
          const resultContainer = sentenceContainer.nextElementSibling; // Find the corresponding result container
          const placeholder =
            resultContainer.querySelector(".exam1-placeholder");

          function moveWord(wordElement) {
            if (wordElement.parentElement === originalContainer) {
              // Move word from original list to result list (before placeholder)
              resultContainer.insertBefore(wordElement, placeholder);
            } else {
              // Move word back to original list
              originalContainer.appendChild(wordElement);
            }

            // Ensure placeholder is always at the end
            resultContainer.appendChild(placeholder);
          }

          // Add click event to each word
          sentenceContainer
            .querySelectorAll(".exam1-content6-variant")
            .forEach((word) => {
              word.addEventListener("click", function () {
                moveWord(this);
              });
            });

          // UIkit drag & drop event
          // UIkit.util.on(resultContainer, "moved", function () {
          //   setTimeout(() => {
          //     resultContainer.appendChild(placeholder);
          //   }, 10); // Prevent UIkit temporary layout changes
          // });

          // Hide placeholder on drag start
          // UIkit.util.on(resultContainer, "start", function () {
          //   // placeholder.style.display = "none";
          // });

          // Show placeholder again if empty
          // UIkit.util.on(resultContainer, "stop", function () {
          //   if (!resultContainer.querySelector(".exam1-content6-variant")) {
          //     placeholder.style.display = "block";
          //   }
          //   setTimeout(() => {
          //     resultContainer.appendChild(placeholder);
          //   }, 10);
          // });
        });

        // Enable dragging across all sentences
        // UIkit.util.on(".exam1-content6-variant", "moved", function (e) {
        //   const wordElement = e.detail[1]; // The dragged element
        //   const targetContainer = e.detail[0]; // The target container

        //   if (targetContainer.classList.contains("exam1-content6-result")) {
        //     targetContainer.insertBefore(
        //       wordElement,
        //       targetContainer.querySelector(".exam1-placeholder")
        //     );
        //   }
        // });
      });
    </script>
  </body>
</html>
