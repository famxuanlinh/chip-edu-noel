<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/uikit@3.20.8/dist/css/uikit.min.css"
    />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="stylesheet" href="css/index.css" />
    <link rel="stylesheet" href="css/output.css" />

    <style>
      .body {
        font-family: "Nunito", sans-serif;
      }
      .scroll-container {
        display: flex;
        height: 100%;
        overflow-x: auto;
        gap: 48px;
        padding: 10px;
        zoom: 0.85;
        align-items: center;
        position: relative;
      }

      .loader {
        width: 40px;
        height: 40px;
        margin: 0 70px;
        margin-bottom: 60px;
        animation: spin 1s linear infinite;
        flex: 0 0 auto;
        background-image: url("public/home1/loading.svg");

        background-size: 100%;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }

        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <div
      class="home !bg-[url('/public/home1/bg1.png')] flex h-screen flex-col uk-position-relative"
    >
      <div class="home-header project-upload-body-title">
        <div style="width: 368px" class="flex-items-center">
          <img
            width="100"
            height="100"
            src="/public/icons/planet3-small.svg"
            alt="icon planet"
          />
          <p class="heading-h3 grayscale-white pl-5">Tiến trình học</p>
        </div>
        <div>
          <div class="flex-items-center">
            <a
              class="btn-animation !h-20 !bg-[#D8EDDD] flex-items-center heading-h3 px-5 button-hover button-primary bg-primary-yellow"
            >
              <span class="px-4 text-[#006638]">Level 0</span>
              <img
                width="32"
                height="32"
                src="public/home1/info.svg"
                alt="icon arrow"
              />
            </a>
          </div>
        </div>
        <div class="uk-inline">
          <button type="button" class="home-header-info-box">
            <div
              class="bg-greenscale-light-green heading-h2 p-5 button-primary-1 bg-primary-yellow flex-items-center space-x-4"
            >
              <div
                class="rounded-full"
                style="
                  background-color: white;
                  width: fit-content;
                  height: fit-content;
                "
              >
                <img
                  class="rounded-full p-1"
                  width="80"
                  height="80"
                  src="public/images/avatar1.png"
                  alt="avatar"
                />
              </div>
              <div class="home-header-info space-y-4">
                <p class="button-l flex-justify-center">Student’s Name</p>
                <div class="flex-items-center">
                  <div
                    class="project-info-tag flex-items-center inner-blur-inner-b2-50 button-s"
                  >
                    <img
                      src="public/icons/star.svg"
                      class="mr-2"
                      width="24"
                      height="24"
                      alt=""
                    />200
                  </div>
                  <div
                    class="project-info-tag flex-items-center inner-blur-inner-b2-50 button-s"
                  >
                    <img
                      src="public/icons/book.svg"
                      class="mr-2"
                      width="24"
                      height="24"
                      alt=""
                    />15 buổi
                  </div>
                </div>
              </div>
            </div>
          </button>
          <div
            class="home-header-dropdown space-x-12"
            uk-dropdown="mode: click; pos: top-right; animation: uk-animation-slide-top-small; duration: 1000"
            id="my-dropdown"
          >
            <div style="display: flex">
              <div class="space-y-5 uk-position-relative" style="width: 410px">
                <a
                  class="rounded-full uk-position-top-left btn-icon flex-justify-center"
                  href="/index.html"
                >
                  <img src="public/icons/switch.svg" width="40" height="40" />
                </a>
                <div
                  class="project-info flex-center space-x-4"
                  style="flex-direction: column"
                >
                  <div
                    class="rounded-full mr-4"
                    style="
                      background-color: white;
                      width: fit-content;
                      height: fit-content;
                      box-shadow: 0px 4px 4px 0px rgba(0, 0, 0, 0.25);
                    "
                  >
                    <img
                      class="rounded-full p-1"
                      width="110"
                      height="110"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="space-y-5">
                    <p class="heading-h3 grayscale-dark-gray mt-6">
                      Student’s Name
                    </p>
                    <div class="flex-items-center">
                      <div
                        class="project-info-tag flex-items-center inner-blur-inner-b2-50 button-s"
                      >
                        <img
                          src="public/icons/star.svg"
                          class="mr-2"
                          width="24"
                          height="24"
                          alt=""
                        />200
                      </div>
                      <div
                        class="project-info-tag flex-items-center inner-blur-inner-b2-50 button-s"
                      >
                        <img
                          src="public/icons/book.svg"
                          class="mr-2"
                          width="24"
                          height="24"
                          alt=""
                        />15 buổi
                      </div>
                    </div>
                  </div>
                </div>
                <button
                  class="button-primary flex-center w-full bg-greenscale-light-green px-5 grayscale-dark-gray button-l"
                  style="height: 60px"
                >
                  <img
                    src="public/icons/pencil.svg"
                    width="40"
                    height="40"
                    alt=""
                  />
                  <span class="flex-1 flex-center"> Dự án cá nhân</span>
                </button>
                <a
                  href="#result-modal"
                  uk-toggle
                  onclick="hideDropdown()"
                  class="button-primary flex-center w-full bg-greenscale-light-green px-5 grayscale-dark-gray button-l"
                  style="height: 60px"
                >
                  <img
                    src="public/icons/medal.svg"
                    width="40"
                    height="40"
                    alt=""
                  />
                  <span class="flex-1 flex-center"> Thành tích</span>
                </a>
                <button
                  class="button-primary flex-center w-full bg-primary-green px-5 grayscale-white button-l"
                  style="height: 60px"
                >
                  <img
                    src="public/icons/parent.svg"
                    width="40"
                    height="40"
                    alt=""
                  />
                  <span class="flex-1 flex-center"> Phụ huynh</span>
                </button>
              </div>
              <div
                class="space-y-10 uk-position-relative"
                style="padding-top: 78px"
              >
                <button
                  type="button"
                  onclick="hideDropdown()"
                  class="rounded-full uk-position-top-right flex-justify-center"
                  style="background-color: transparent"
                >
                  <img src="public/icons/x2.svg" width="40" height="40" />
                </button>
                <p class="caption-m grayscale-dark-gray flex-center">
                  Đổi ảnh đại diện
                </p>
                <div class="home-header-dropdown-avatars px-10">
                  <div class="rounded-full bg-grayscale-white">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="rounded-full bg-grayscale-white">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="rounded-full bg-grayscale-white">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="rounded-full bg-grayscale-white">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="rounded-full bg-grayscale-white">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="rounded-full bg-grayscale-white">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="rounded-full bg-grayscale-white">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="rounded-full bg-grayscale-white">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="rounded-full bg-grayscale-white">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="rounded-full bg-grayscale-white">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                  <div class="rounded-full bg-primary-green">
                    <img
                      class="rounded-full p-2"
                      width="96"
                      height="96"
                      src="public/images/avatar1.png"
                      alt="avatar"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="lesson-container" class="scroll-container relative">
        <button
          class="fixed left-5 transform -translate-y-1/2 z-99"
          id="left-arrow"
        >
          <img
            src="public/home1/arrow-right.svg"
            width="40"
            height="40"
            alt=""
            style="transform: rotate(180deg)"
          />
        </button>
        <button
          class="fixed right-5 transform -translate-y-1/2 z-99"
          id="right-arrow"
        >
          <img
            src="public/home1/arrow-right.svg"
            width="40"
            height="40"
            alt=""
          />
        </button>
        <button
          id="back-to-active-left"
          class="fixed top-30 left-0 z-100 hidden"
        >
          <img width="60" src="public/home1/back-to-active.png" alt="back" />
        </button>

        <button
          id="back-to-active-right"
          class="fixed top-30 right-0 z-100 hidden"
          style="transform: scaleX(-1)"
        >
          <img width="60" src="public/home1/back-to-active.png" alt="back" />
        </button>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.20.8/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.20.8/dist/js/uikit-icons.min.js"></script>
    <script>
      const container = document.getElementById("lesson-container");
      const totalItems = 100;
      const activeItem = 41;
      const visibleBefore = 10;
      const visibleAfter = 10;
      const loadedItems = new Set();
      let isLoading = false;
      let lastLoadDirection = null;

      function createItem(index) {
        // Test big card
        if (index === 49) {
          return `
              <div class="course-card test-card">
      <div class="relative w-full">
        <div class="test-card-title">Mid-term Test</div>
        <div class="mb-5 mx-6">
          <div class="flex items-center space-x-5">
            <div
              class="level-modal-tag bg-white"
              style="height: 105px; width: 172px"
            >
              <img
                width="60"
                height="60"
                src="/public/icons/tag-units.svg"
                alt="tag"
              />
              <div class="flex items-center gap-2">
                <p class="heading-h3 primary-green">20</p>
                <p class="button-xs pb-1">Units</p>
              </div>
            </div>
            <div
              id="small-scroll-exception"
              class="space-y-4 flex-1 pr-1 h-[105px] overflow-y-auto"
            >
              <div class="h-10 level-button-unit w-full bg-grayscale-white">
                <button class="level-left-part w-19 !text-base button-s">
                  Unit 1
                </button>
                <button
                  class="level-right-part !text-base button-l line-clamp-1"
                >
                  Lesson 1 he as alo
                </button>
              </div>
              <div class="h-10 level-button-unit w-full bg-grayscale-white">
                <button class="level-left-part w-19 button-s">Unit 2</button>
                <button
                  class="level-right-part !text-base button-l line-clamp-1"
                >
                  Lesson 2
                </button>
              </div>
              <div class="h-10 level-button-unit w-full bg-grayscale-white">
                <button class="level-left-part w-19 button-s">Unit 3</button>
                <button
                  class="level-right-part !text-base button-l line-clamp-1"
                >
                  Lesson 3
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="grid grid-cols-2 m-6 items-stretch gap-5.5">
          <div
            class="flex-1 border-2 p-5 rounded-2xl bg-[#FFFBFBCC] border-black/10 flex justify-center"
            id="slide-1"
          >
            <div class="flex flex-col justify-between w-full">
              <div class="flex flex-col justify-between h-full">
                <div class="space-y-5">
                  <div class="flex justify-center items-center">
                    <img
                      class="rounded-full -ml-5"
                      width="48"
                      height="48"
                      src="public/exam2/mic.png"
                      alt="avatar"
                    />
                    <p class="button-l !text-lg text-black">Kỹ năng Nói</p>
                  </div>

                  <div class="flex flex-col items-center">
                    <div class="avatar-bg">
                      <img
                        class="rounded-full p-1"
                        width="64"
                        height="64"
                        src="public/images/avatar1.png"
                        alt="avatar"
                      />
                    </div>
                    <div class="grayscale-dark-gray button-l mt-5">Cô Tina</div>
                  </div>

                  <div
                    class="text-[15px] text-center !leading-[160%] text-[#252525]"
                  >
                    Bạn sẽ vào lớp học online trả lời câu hỏi của Giáo viên và
                    được chấm điểm. Nhớ khi đến giờ, bấm
                    <strong>"Vào lớp"</strong> để bắt đầu nhé!
                  </div>
                </div>

                <div>
                  <div
                    class="w-full mt-6 flex flex-col items-center button-shadow bg-[#FF9800] px-2 py-3 space-y-3"
                  >
                    <div class="flex items-center">
                      <img
                        width="36"
                        height="36"
                        class="mr-3"
                        src="public/icons/rocket.svg"
                        alt="avatar"
                      />
                      <p class="button-l text-white">Vào lớp</p>
                    </div>

                    <div
                      class="flex items-center w-full font-bold bg-white !text-xl inner-blur-inner-b4-20 justify-between"
                      style="
                        padding: 10px 8px;
                        border-radius: 12px;
                        border: 2px solid rgba(0, 0, 0, 0.05);
                      "
                    >
                      <div
                        class="flex items-center  grayscale-dark-gray"
                      >
                        <img
                          width="18"
                          height="18"
                          class="mr-2"
                          src="public/icons/clock.svg"
                          alt="clock"
                        />04:59
                      </div>
                      <div
                        class="flex items-center  grayscale-dark-gray"
                      >
                        <img
                          width="18"
                          height="18"
                          class="mr-2"
                          src="public/icons/calendar-gray.svg"
                          alt="calendar"
                        />Thứ 2 - 12/12/2024
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="flex-1 flex flex-col justify-between">
            <div
              class="border-2 p-5 rounded-2xl bg-[#FFFBFBCC] border-black/10 flex justify-center h-full"
            >
              <div class="flex flex-col justify-between w-full">
                <div class="space-y-6">
                  <div class="flex justify-center items-center">
                    <img
                      class="rounded-full -ml-5"
                      width="36"
                      height="36"
                      src="public/exam2/speaker.png"
                      alt="avatar"
                    />
                    <p class="button-l !text-lg text-black">
                      Kỹ năng Nghe - Đọc - Viết
                    </p>
                  </div>

                  <div class="flex flex-col items-center">
                    <div class="text-[#FF9800] text-[40px] mb-2 heading-h3">
                      30:00
                    </div>
                    <div class="text-[15px] font-bold">Thời gian làm</div>
                  </div>

                  <div
                    class="text-[15px] text-center !leading-[160%] text-[#252525]"
                  >
                    Bạn sẽ làm bài kiểm tra trên máy, gồm các phần Nghe hiểu,
                    Đọc - Viết.
                  </div>
                </div>

                <a
                  href="#congrats-modal"
                  uk-toggle
                  class="grayscale-white h-12 mt-12.5 btn-animation flex justify-center items-center heading-h3 px-5 button-hover button-primary bg-[#00B26B] !text-2xl"
                >
                  Làm bài kiểm tra
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>`;
        }

        // Unit card
        if (index === 50) {
          return `
            <div
      class="course-card bg-[url('/public/home1/unit.svg')] flex-none bg-size-cover bg-no-repeat w-50 h-[508px] flex items-end justify-center"
    >
      <div class="text-center text-2xl font-bold text-[#454575] mb-25">
        <p>Unit 4</p>
        <p>Emotional</p>
      </div>
    </div>`;
        }

        // Future card
        if (index > 41) {
          return `
           <div class="card3-lesson course-card">
      <img
        class="absolute -top-8 -right-8"
        width="76"
        height="76"
        src="public/home1/lesson-lock.svg"
        alt="avatar"
      />
      <div class="card3-header opacity-40">
        <div class="card3-header-subtitle">
          <p class="">Unit 3</p>
          <div class="w-[1px] my-1 h-4.5 bg-black/20"></div>
          <p>Lesson 3</p>
        </div>
        <h3 class="card3-header-title">I can swim</h3>
      </div>
      <div class="card3-content">
      ${
        index % 2 === 0
          ? ` <div class="card3-content-teacher opacity-40">
          <img
            class="rounded-full"
            width="100"
            height="100"
            src="public/images/avatar1.png"
            alt="avatar"
          />
          <p class="card3-content-teacher-name">Cô Tina</p>
        </div>`
          : `<div class="card3-content-unit opacity-40">
          <p class="card3-content-unit-name">
            <img
              class="rounded-full mr-3"
              width="32"
              height="32"
              src="public/home1/book.svg"
              alt="avatar"
            />Unit 3
          </p>
          <div class="card3-content-unit-list">
            <div>Unit 2: You can sing</div>
            <div>Unit 3 You can talk</div>
          </div>
        </div>`
      }
       
        
      </div>
      <div class="card3-footer">
        <div
          class="m-6 flex items-center justify-center button-shadow bg-[#D8EDDD] px-2 py-3 space-y-3"
          style="flex-direction: column"
        >
          <div class="flex items-center justify-center">
            <img
              width="32"
              height="32"
              class="mr-3"
              src="public/home1/clock-color.svg"
              alt="avatar"
            />
            <p class="button-l grayscale-dark-gray ml-3">2 ngày nữa</p>
          </div>
          <div
            class="flex-items-center w-full bg-white inner-blur-inner-b4-20"
            style="
              padding: 10px 8px;
              justify-content: space-between;
              border-radius: 12px;
              border: 2px solid rgba(0, 0, 0, 0.05);
            "
          >
            <div
              class="flex items-center justify-center caption-s grayscale-dark-gray"
            >
              20:00 - Thứ 2 12/12/2024
            </div>
          </div>
        </div>
      </div>
    </div>`;
        }

        // Current card
        if (index === 41) {
          return `
  <div class="card2-lesson course-card active">
      <img
        class="absolute -top-8 -right-8"
        width="80"
        height="80"
        src="public/home1/lesson-current.svg"
        alt="avatar"
      />
      <div class="card2-header">
        <div class="card2-header-subtitle">
          <p class="">Unit 3</p>
          <div class="w-[1px] my-1 h-4.5 bg-black/20"></div>
          <p>Lesson 3</p>
        </div>
        <h3 class="card2-header-title">I can swim</h3>
      </div>
      <div class="card2-content">
        <div class="card2-content-teacher">
          <img
            class="rounded-full"
            width="160"
            height="160"
            src="public/images/avatar1.png"
            alt="avatar"
          />
          <p class="card2-content-teacher-name !text-white">Cô Tina</p>
        </div>
       <div class=" m-6 flex flex-col items-center button-shadow bg-[#FF9800] px-2 py-3 space-y-3">
                    <div class="flex items-center">
                      <img width="36" height="36" class="mr-3" src="public/icons/rocket.svg" alt="avatar">
                      <p class="button-l text-white">Vào lớp</p>
                    </div>

                    <div class="flex items-center w-full font-bold bg-white !text-xl inner-blur-inner-b4-20 justify-between" style="
                        padding: 10px 8px;
                        border-radius: 12px;
                        border: 2px solid rgba(0, 0, 0, 0.05);
                      ">
                      <div class="flex items-center  grayscale-dark-gray">
                        <img width="18" height="18" class="mr-2" src="public/icons/clock.svg" alt="clock">04:59
                      </div>
                      <div class="flex items-center  grayscale-dark-gray">
                        <img width="18" height="18" class="mr-2" src="public/icons/calendar-gray.svg" alt="calendar">Thứ 2 - 12/12/2024
                      </div>
                    </div>
                  </div>
        <div
          class="h-12 my-6 text-xl font-bold text-white flex justify-center items-center"
        >
          <img
            src="public/home1/book-white.svg"
            width="20"
            class="mr-3"
            height="20"
            alt="upload"
          />Xem nội dung
        </div>
        <div class="card2-content-progress">
          <div class="card2-content-progress-point w-full grid grid-cols-3">
            <div class="items-center flex justify-center">
              <p class="w-full"></p>
              <img
                src="public/home1/active-point-green.svg"
                width="32"
                height="32"
                alt="upload"
              />
              <div class="w-full h-0.5 bg-white"></div>
            </div>
            <div class="items-center flex justify-center">
              <div class="w-full h-0.5 bg-white"></div>
              <div class="size-5 flex-none rounded-full bg-[#CAE2BD]"></div>
              <div class="w-full h-0.5 bg-white"></div>
            </div>
            <div class="items-center flex justify-center">
              <div class="w-full h-0.5 bg-white"></div>
              <div class="size-5 flex-none rounded-full bg-[#CAE2BD]"></div>
              <p class="w-full"></p>
            </div>
          </div>
          <div class="card2-content-progress-desc w-full grid grid-cols-3">
            <div class="text-white">Xem nội dung</div>
            <div class="text-white/60">Vào lớp</div>
            <div class="text-white/60">Luyện tập</div>
          </div>
        </div>
      </div>
    </div>
            `;
        }

        // Past card
        return `
                <div class="card-lesson course-card">
      <img
        class="absolute -top-8 -right-8"
        width="76"
        height="76"
        src="public/home1/lesson-active.svg"
        alt="avatar"
      />
      <div class="card-header">
        <div class="card-header-subtitle">
          <p class="">Unit 3</p>
          <div class="w-[1px] my-1 h-4.5 bg-black/20"></div>
          <p>Lesson 3</p>
        </div>
        <h3 class="card-header-title">I can swim</h3>
      </div>
      <div class="card-content">
        <div class="card-content-teacher">
          <img
            class="rounded-full"
            width="100"
            height="100"
            src="public/images/avatar1.png"
            alt="avatar"
          />
          <p class="card-content-teacher-name">Cô Tina</p>
        </div>
        <div class="card-content-buttons">
          <a href="#" class="card-content-buttons-left hover:!text-black">
            <img
              src="public/home1/book1.svg"
              width="20"
              class="mr-3"
              height="20"
              alt="upload"
            />Nội dung
          </a>
          <button
            class="card-content-buttons-right flex items-center px-4 bg-[#00B26B] text-white button-primary btn-animation"
          >
            <img
              src="public/home1/game-pad.svg"
              class="mr-3"
              width="32"
              height="32"
              alt="upload"
            />
            Luyện tập
          </button>
        </div>
        <div class="card-content-schedule">
          <span class="card-content-time">20:00 - Thứ 2 12/12/2024</span>
        </div>
        <div class="card-content-progress">
          <div class="card-content-progress-point w-full grid grid-cols-3">
            <div class="items-center flex justify-center">
              <p class="w-full"></p>
              <img
                src="public/home1/active-point.svg"
                width="32"
                height="32"
                alt="upload"
              />
              <div class="w-full h-0.5 bg-[#00B26B]"></div>
            </div>
            <div class="items-center flex justify-center">
              <div class="w-full h-0.5 bg-[#00B26B]"></div>
              <img
                src="public/home1/active-point.svg"
                width="32"
                height="32"
                alt="upload"
              />
              <div class="w-full h-0.5 bg-[#E5E5E5]"></div>
            </div>
            <div class="items-center flex justify-center">
              <div class="w-full h-0.5 bg-[#E5E5E5]"></div>
              <div
                class="size-5 flex-none rounded-full bg-[#e5e5e5] border border-white"
              ></div>
              <p class="w-full"></p>
            </div>
          </div>
          <div class="card-content-progress-desc w-full grid grid-cols-3">
            <div>Xem nội dung</div>
            <div>Vào lớp</div>
            <div class="text-black/40">Luyện tập</div>
          </div>
        </div>
      </div>
    </div>
          `;
      }

      function insertLoader(prepend) {
        const loader = document.createElement("div");
        loader.className = "loader";
        if (prepend) {
          container.prepend(loader);
        } else {
          container.appendChild(loader);
        }
        return loader;
      }

      async function loadItems(start, end, prepend = false) {
        if (isLoading) return;
        isLoading = true;

        const loader = insertLoader(prepend);
        const prevScrollLeft = container.scrollLeft;
        const prevScrollWidth = container.scrollWidth;

        await new Promise((resolve) => setTimeout(resolve, 1000));
        loader.remove();

        const items = [];
        for (let i = start; i <= end; i++) {
          if (i < 1 || i > totalItems || loadedItems.has(i)) continue;
          const el = createItem(i);
          items.push(el);
          loadedItems.add(i);
        }

        if (items.length === 0) {
          isLoading = false;
          return;
        }

        if (prepend) {
          items
            .reverse()
            .forEach((elHTML) =>
              container.insertAdjacentHTML("afterbegin", elHTML)
            );
          const scrollDiff = container.scrollWidth - prevScrollWidth;
          container.scrollLeft = prevScrollLeft + scrollDiff;
        } else {
          items.forEach((elHTML) =>
            container.insertAdjacentHTML("beforeend", elHTML)
          );
        }

        isLoading = false;
      }

      async function initialize() {
        const from = activeItem - visibleBefore;
        const to = activeItem + visibleAfter;
        await loadItems(from, to);

        requestAnimationFrame(() => {
          const activeEl = container.querySelector(".course-card.active");
          if (activeEl) {
            const left = activeEl.offsetLeft;
            container.scrollTo({
              left: left - container.clientWidth / 2 + activeEl.offsetWidth / 2,
              behavior: "smooth",
            });
          }
        });
      }

      let debounceTimer = null;

      container.addEventListener(
        "wheel",
        function (event) {
          if (event.deltaY !== 0) {
            event.preventDefault();
            container.scrollLeft += event.deltaY;
          }
        },
        { passive: false }
      );

      container.addEventListener("scroll", () => {
        if (isLoading) return;

        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => {
          const scrollLeft = container.scrollLeft;
          const scrollRight =
            container.scrollWidth - scrollLeft - container.clientWidth;

          const loadedIndexes = [...loadedItems];
          if (loadedIndexes.length === 0) return;

          const firstItem = Math.min(...loadedIndexes);
          const lastItem = Math.max(...loadedIndexes);

          if (
            scrollLeft < 100 &&
            lastLoadDirection !== "left" &&
            firstItem > 1
          ) {
            lastLoadDirection = "left";
            loadItems(firstItem - 10, firstItem - 1, true).then(() => {
              lastLoadDirection = null;
            });
          }

          if (
            scrollRight < 100 &&
            lastLoadDirection !== "right" &&
            lastItem < totalItems
          ) {
            lastLoadDirection = "right";
            loadItems(lastItem + 1, lastItem + 10, false).then(() => {
              lastLoadDirection = null;
            });
          }
        }, 100);
      });

      function scrollToNextItem(direction = 1) {
        const items = [...container.querySelectorAll(".course-card")];
        const currentScroll = container.scrollLeft;
        const containerMid = currentScroll + container.clientWidth / 2;

        let centerIndex = items.findIndex((el) => {
          const elLeft = el.offsetLeft;
          const elRight = elLeft + el.offsetWidth;
          return elLeft <= containerMid && elRight >= containerMid;
        });

        if (centerIndex === -1) return;

        const targetIndex = centerIndex + direction;
        const target = items[targetIndex];
        if (!target) return;

        container.scrollTo({
          left:
            target.offsetLeft -
            container.clientWidth / 2 +
            target.offsetWidth / 2,
          behavior: "smooth",
        });
      }

      document.getElementById("left-arrow").addEventListener("click", () => {
        scrollToNextItem(-1);
      });

      document.getElementById("right-arrow").addEventListener("click", () => {
        scrollToNextItem(1);
      });

      initialize();
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const leftBtn = document.getElementById("back-to-active-left");
        const rightBtn = document.getElementById("back-to-active-right");
        const container = document.getElementById("lesson-container");

        const getActiveCard = () =>
          document.querySelector(".course-card.active");

        const updateButtons = () => {
          const target = getActiveCard();
          if (!target) return;

          const containerRect = container.getBoundingClientRect();
          const targetRect = target.getBoundingClientRect();

          const isLeftOut = targetRect.right < containerRect.left;
          const isRightOut = targetRect.left > containerRect.right;

          leftBtn.classList.toggle("hidden", !isLeftOut);
          rightBtn.classList.toggle("hidden", !isRightOut);
        };

        const scrollToActive = () => {
          const target = getActiveCard();
          if (target) {
            target.scrollIntoView({ behavior: "smooth", inline: "center" });
          }
        };

        leftBtn.addEventListener("click", scrollToActive);
        rightBtn.addEventListener("click", scrollToActive);

        // Use scroll event on the container
        container.addEventListener("scroll", updateButtons);

        // Also update on resize (viewport might change visibility)
        window.addEventListener("resize", updateButtons);

        // Initial update after slight delay
        setTimeout(updateButtons, 300);
      });
    </script>
  </body>
</html>
