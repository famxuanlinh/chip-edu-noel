<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kiểm tra đầu vào</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/uikit@3.20.8/dist/css/uikit.min.css"
    />
    <link rel="stylesheet" href="css/app.css" />
    <link rel="stylesheet" href="css/output.css" />
  </head>
  <body>
    <div class="exam1">
      <div class="exam1-header">
        <div class="flex items-center">
          <img class="mr-2" src="/public/exam/icons/arrow-back.svg" alt="" />
          <p class="text-[28px] font-extrabold text-[#006638]">
            Bài kiểm tra Nghe hiểu
          </p>
        </div>
        <div class="relative flex items-center w-fit">
          <img id="timer-img" src="/public/exam/timer1.png" alt="Timer" />
          <p
            id="timer-text"
            class="text-[28px] font-extrabold text-[#006638] absolute top-1/2 left-[43%] transform -translate-y-1/2"
          >
            00:00
          </p>
        </div>

        <div class="w-full justify-end flex items-center h-full">
          <a class="w-fit" href="/kiem-tra.html">
            <img width="24" src="/public/exam/icons/x-gray.svg" alt="x" />
          </a>
        </div>
      </div>
      <div class="flex items-center gap-8 px-8">
        <button
          class="button-primary btn-animation size-16 flex justify-center items-center button-m bg-[#A9A9A9]"
          style="border-radius: 100%"
        >
          <img
            class="w-6 mr-1.5 rotate-180"
            src="/public/exam/icons/play-solid.svg"
            alt=""
          />
        </button>
        <div class="flex-1 exam1-content w-full rounded-2xl">
          <!-- Start content 2 -->
          <div class="test9 flex gap-10">
            <div class="exam1-content9 w-full exam1-height">
              <div class="exam1-zoom flex flex-col h-full">
                <div>
                  <div class="flex items-start gap-6 toggle-trans-container">
                    <div
                      class="text-[32px] font-extrabold text-[#3A3335] flex-1"
                    >
                      Look at the pictures and read the story. Write some words
                      to complete the sentences about the story. You can use 1,
                      2 or 3 words.
                    </div>
                    <div
                      class="toggle-trans flex flex-none cursor-pointer gap-2 w-fit items-center rounded-4xl border justify-center border-[#000000]/20 py-1 pr-1 pl-3"
                    >
                      Dịch
                      <img
                        src="/public/exam1/icons/america.svg"
                        class="size-9 rounded-full"
                        alt=""
                      />
                    </div>
                  </div>

                  <div
                    class="flex items-start gap-6 toggle-trans-container hidden"
                  >
                    <div
                      class="text-[32px] font-extrabold text-[#3A3335] flex-1"
                    >
                      Look at the pictures and read the story. Write some words
                      to complete the sentences about the story. You can use 1,
                      2 or 3 words vietnam.
                    </div>
                    <div
                      class="toggle-trans flex flex-none cursor-pointer gap-2 w-fit items-center rounded-4xl border justify-center border-[#000000]/20 py-1 pl-1 pr-3"
                    >
                      <img
                        src="/public/exam1/icons/vietnam.svg"
                        class="size-9 rounded-full"
                        alt=""
                      />
                      Trans
                    </div>
                  </div>
                </div>

                <div class="flex grow-1 overflow-hidden mt-10 gap-10">
                  <div class="flex-1 h-full overflow-y-auto">
                    <div class="flex flex-col gap-6">
                      <div class="flex justify-center">
                        <img
                          src="public/exam1/image 11.png"
                          class="!h-[235px] object-contain rounded-[20px] flex-none"
                          alt=""
                        />
                      </div>
                      <di
                        class="text-[28px] font-bold leading-[150%] text-[#3A3335]"
                      >
                        In many ......(1)....... countries there are four
                        seasons in the year. These are called spring, summer,
                        autumn and winter. ......(2)...... season is about three
                        months long and then a new season comes. In the north of
                        our planet summer usually ....(3)... in June. It is the
                        warmest time of the year and it sometimes does not get
                        dark ......(4)...... 10 o’clock at night. In September
                        it gets colder and the trees .......(5).... their
                        leaves. This season is called autumn. Winter comes in
                        December .....(6).... it is usually very cold and a lot
                        of countries have snow. On some winter days, it gets
                        dark at about 4 o’clock .....(7)...... the afternoon so
                        the days are very ......(8)....... and the nights are
                        long. In March the weather gets warmer and plants and
                        flowers start to grow ......(9)....... . This season is
                        called spring. In the south of the planet the countries
                        have the ....(10)...... seasons, but they happen at
                        different times ...................... the year. They
                        have summer in December and winter in June.
                      </di>
                    </div>
                  </div>
                  <div class="flex-1 h-full pb-2 overflow-y-auto">
                    <div class="flex gap-4 flex-col">
                      <div class="exam1-content9-sentence gap-6">
                        <div class="exam1-content9-answer">1</div>
                        <div class="grid grid-cols-3 w-full gap-6 flex-1">
                          <div class="exam1-content9-variant">temperate</div>
                          <div class="exam1-content9-variant">temperated</div>
                          <div class="exam1-content9-variant">temperature</div>
                        </div>
                      </div>
                      <div class="exam1-content9-sentence gap-6">
                        <div class="exam1-content9-answer">2</div>
                        <div class="grid grid-cols-3 w-full gap-6 flex-1">
                          <div class="exam1-content9-variant">only</div>
                          <div class="exam1-content9-variant">each</div>
                          <div class="exam1-content9-variant">can</div>
                        </div>
                      </div>
                      <div class="exam1-content9-sentence gap-6">
                        <div class="exam1-content9-answer">3</div>
                        <div class="grid grid-cols-3 w-full gap-6 flex-1">
                          <div class="exam1-content9-variant">began</div>
                          <div class="exam1-content9-variant">begin</div>
                          <div class="exam1-content9-variant">begins</div>
                        </div>
                      </div>
                      <div class="exam1-content9-sentence gap-6">
                        <div class="exam1-content9-answer">4</div>
                        <div class="grid grid-cols-3 w-full gap-6 flex-1">
                          <div class="exam1-content9-variant">temperate</div>
                          <div class="exam1-content9-variant">temperated</div>
                          <div class="exam1-content9-variant">temperature</div>
                        </div>
                      </div>
                      <div class="exam1-content9-sentence gap-6">
                        <div class="exam1-content9-answer">5</div>
                        <div class="grid grid-cols-3 w-full gap-6 flex-1">
                          <div class="exam1-content9-variant">only</div>
                          <div class="exam1-content9-variant">each</div>
                          <div class="exam1-content9-variant">can</div>
                        </div>
                      </div>
                      <div class="exam1-content9-sentence gap-6">
                        <div class="exam1-content9-answer">6</div>
                        <div class="grid grid-cols-3 w-full gap-6 flex-1">
                          <div class="exam1-content9-variant">began</div>
                          <div class="exam1-content9-variant">begin</div>
                          <div class="exam1-content9-variant">begins</div>
                        </div>
                      </div>
                      <div class="exam1-content9-sentence gap-6 result">
                        <div class="exam1-content9-answer">7</div>
                        <div class="grid grid-cols-3 w-full gap-6 flex-1">
                          <div class="exam1-content9-variant">temperate</div>
                          <div class="exam1-content9-variant true">
                            temperated
                          </div>
                          <div class="exam1-content9-variant">temperature</div>
                        </div>
                      </div>
                      <div class="exam1-content9-sentence gap-6 result">
                        <div class="exam1-content9-answer">8</div>
                        <div class="grid grid-cols-3 w-full gap-6 flex-1">
                          <div class="exam1-content9-variant">only</div>
                          <div class="exam1-content9-variant fail">each</div>
                          <div class="exam1-content9-variant">can</div>
                        </div>
                      </div>
                      <div class="exam1-content9-sentence gap-6 result">
                        <div class="exam1-content9-answer">9</div>
                        <div class="grid grid-cols-3 w-full gap-6 flex-1">
                          <div class="exam1-content9-variant true">began</div>
                          <div class="exam1-content9-variant">begin</div>
                          <div class="exam1-content9-variant">begins</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- End content 2 -->
        </div>
      </div>

      <div class="exam1-footer">
        <div class="flex items-center gap-2">
          <a href="#" class="exam1-footer-num done">Part 1</a>
          <a href="#" class="exam1-footer-num active">Part 2</a>
          <a href="#exam-unfinished" uk-toggle class="exam1-footer-num"
            >Part 3</a
          >
          <a href="#exam-submit-early" uk-toggle class="exam1-footer-num"
            >Part 4</a
          >
          <a href="#exam-done" uk-toggle class="exam1-footer-num">Part 5</a>
          <a href="#" class="exam1-footer-num">Part 6</a>
          <a href="#" class="exam1-footer-num">Part 7</a>
        </div>
        <a
          href="#exam-exit"
          uk-toggle
          class="button-primary btn-animation w-fit flex justify-center items-center px-5 button-m bg-[#00b26b]"
          style="height: 56px; color: white"
        >
          Nộp bài
        </a>
      </div>
    </div>

    <div id="exam-done" class="uk-flex-top" uk-modal>
      <div
        style="
          height: fit-content;
          width: 760px !important;
          border-radius: 20px;
        "
        class="level-modal uk-modal-dialog space-y-10 uk-modal-body uk-margin-auto-vertical"
      >
        <div class="flex justify-between items-center">
          <p></p>
          <p class="heading-h2 text-[#252525]">Tuyệt vời!</p>
          <button
            type="button"
            onclick="hideModal('exam-done')"
            class="rounded-full flex-justify-center"
            style="background-color: transparent"
          >
            <img src="public/icons/x2.svg" width="40" height="40" />
          </button>
        </div>
        <div>
          <div class="rounded-3xl" style="margin-top: 70px">
            <div class="pb-10 flex-justify-center">
              <p class="my-6 text-center text-[#252525] text-2xl">
                Bạn đã hoàn thành bài Nghe.
              </p>
            </div>
            <div class="flex justify-center">
              <a
                href="kiem-tra2.html"
                class="button-primary btn-animation flex items-center justify-center !w-60 bg-primary-green px-5 grayscale-white button-m"
                style="height: 56px; color: white; background-color: #00b26b"
              >
                Tiếp tục
              </a>
            </div>
            <p class="pt-4 text-center text-lg text-[#252525]/40">
              Tự động chuyển sau <span id="countdown">5</span>s
            </p>
          </div>
        </div>
      </div>
    </div>
    <div id="exam-submit-early" class="uk-flex-top" uk-modal>
      <div
        style="
          height: fit-content;
          width: 760px !important;
          border-radius: 20px;
        "
        class="level-modal uk-modal-dialog space-y-10 uk-modal-body uk-margin-auto-vertical"
      >
        <div class="flex justify-between items-center">
          <p></p>
          <p class="heading-h2 text-[#252525]">Nộp bài sớm</p>
          <button
            type="button"
            onclick="hideModal('exam-submit-early')"
            class="rounded-full flex-justify-center"
            style="background-color: transparent"
          >
            <img src="public/icons/x2.svg" width="40" height="40" />
          </button>
        </div>
        <div>
          <div class="space-y-10 rounded-3xl" style="margin-top: 70px">
            <div class="flex-justify-center">
              <p class="pb-6 text-center text-black text-[28px] font-extrabold">
                Thời gian còn lại: 12 phút 40 giây
              </p>
              <p class="my-6 text-center text-[#252525] text-2xl">
                Vẫn còn thời gian để kiểm tra lại trước khi nộp bài.
                <br />
                Bạn có chắc muốn nộp bài sớm không?
              </p>
            </div>
            <div class="space-y-10">
              <div class="space-x-3 flex items-center">
                <button
                  onclick="hideModal('exam-submit-early')"
                  class="button-primary btn-animation flex-1 w-full flex justify-center items-center px-5 button-m text-black bg-[#D8EDDD]"
                  style="height: 56px"
                >
                  Bài kiểm tra lại bài
                </button>
                <button
                  type="button"
                  uk-toggle="target: #exam-done"
                  class="button-primary flex-1 btn-animation w-full flex-center bg-primary-green px-5 grayscale-white button-m"
                  style="height: 56px; color: white; background-color: #00b26b"
                >
                  Nộp bài
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="exam-unfinished" class="uk-flex-top" uk-modal>
      <div
        style="
          height: fit-content;
          width: 760px !important;
          border-radius: 20px;
        "
        class="level-modal uk-modal-dialog space-y-10 uk-modal-body uk-margin-auto-vertical"
      >
        <div class="flex justify-between items-center">
          <p></p>
          <p class="heading-h2 text-[#252525]">Chưa hoàn thành</p>
          <button
            type="button"
            onclick="hideModal('exam-unfinished')"
            class="rounded-full flex-justify-center"
            style="background-color: transparent"
          >
            <img src="public/icons/x2.svg" width="40" height="40" />
          </button>
        </div>
        <div>
          <div class="space-y-10 rounded-3xl" style="margin-top: 70px">
            <div class="flex-justify-center">
              <p class="pb-6 text-center text-black text-[28px] font-extrabold">
                Thời gian còn lại: 12 phút 40 giây
              </p>
              <p class="my-6 text-center text-[#252525] text-2xl">
                Bạn chưa hoàn thành hết bài kiểm tra.
                <br />
                Bạn có chắc muốn nộp bài sớm không?
              </p>
            </div>
            <div class="space-y-10">
              <div class="space-x-3 flex items-center">
                <button
                  onclick="hideModal('exam-unfinished')"
                  class="button-primary btn-animation flex-1 w-full flex justify-center items-center px-5 button-m text-black bg-[#D8EDDD]"
                  style="height: 56px"
                >
                  Tiếp tục làm bài
                </button>
                <button
                  type="button"
                  uk-toggle="target: #exam-done"
                  class="button-primary flex-1 btn-animation w-full flex-center bg-primary-green px-5 grayscale-white button-m"
                  style="height: 56px; color: white; background-color: #00b26b"
                >
                  Nộp bài
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="exam-exit" class="uk-flex-top" uk-modal>
      <div
        style="
          height: fit-content;
          width: 760px !important;
          border-radius: 20px;
        "
        class="level-modal uk-modal-dialog space-y-10 uk-modal-body uk-margin-auto-vertical"
      >
        <div class="flex justify-between items-center">
          <p></p>
          <p class="heading-h2 text-[#252525]">Thoát Bài kiểm tra</p>
          <button
            type="button"
            onclick="hideModal('exam-exit')"
            class="rounded-full flex-justify-center"
            style="background-color: transparent"
          >
            <img src="public/icons/x2.svg" width="40" height="40" />
          </button>
        </div>
        <div>
          <div class="space-y-10 rounded-3xl" style="margin-top: 70px">
            <div class="flex-justify-center">
              <p class="my-6 text-center text-[#252525] text-2xl">
                Sắp hoàn thành rồi bạn ơi! Nếu thoát bây giờ lần tới sẽ phải làm
                lại bài kiểm tra lại từ đầu đó.
              </p>
            </div>
            <div class="space-y-10">
              <div class="space-x-3 flex items-center">
                <a
                  href="/kiem-tra.html"
                  class="button-primary btn-animation flex-1 w-full flex justify-center items-center px-5 button-m bg-[#FF6047]"
                  style="height: 56px; color: white"
                >
                  Vẫn thoát
                </a>
                <button
                  type="button"
                  onclick="hideModal('exam-exit')"
                  class="button-primary flex-1 btn-animation w-full flex-center bg-primary-green px-5 grayscale-white button-m"
                  style="height: 56px; color: white; background-color: #00b26b"
                >
                  Ở lại
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/uikit@3.20.8/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.20.8/dist/js/uikit-icons.min.js"></script>
    <script>
      function hideModal(modalId) {
        const dropdownElement = document.getElementById(modalId);

        UIkit.modal(dropdownElement).hide(0);
      }

      function startCountdown() {
        let timeLeft = 5;
        const countdownElement = document.getElementById("countdown");

        countdownElement.textContent = timeLeft; // Cập nhật lần đầu

        const countdownInterval = setInterval(() => {
          timeLeft--;
          countdownElement.textContent = timeLeft;

          if (timeLeft <= 0) {
            clearInterval(countdownInterval);
            window.location.href = "kiem-tra2.html";
          }
        }, 1000);

        // Lưu interval vào modal để có thể dừng lại khi modal đóng
        document.getElementById("exam-done").dataset.countdown =
          countdownInterval;
      }

      function stopCountdown() {
        const countdownInterval =
          document.getElementById("exam-done").dataset.countdown;
        if (countdownInterval) {
          clearInterval(countdownInterval);
        }
      }

      // Lắng nghe sự kiện mở modal từ UIkit
      UIkit.util.on("#exam-done", "shown", startCountdown);
      UIkit.util.on("#exam-done", "hidden", stopCountdown);
    </script>
    <script>
      function startCountdown(durationInSeconds) {
        let timerElement = document.getElementById("timer-text");
        let timerImage = document.getElementById("timer-img");
        let remainingTime = durationInSeconds;

        function updateTimer() {
          let minutes = Math.floor(remainingTime / 60);
          let seconds = remainingTime % 60;

          // Định dạng số giây thành 2 chữ số (ví dụ: 09 thay vì 9)
          let formattedTime = `${minutes}:${seconds < 10 ? "0" : ""}${seconds}`;
          timerElement.textContent = formattedTime;

          // Thay đổi hình ảnh nếu thời gian còn dưới 1 phút
          if (remainingTime < 60) {
            timerImage.src = "/public/exam/timer2.png";
            timerElement.style.color = "#A21600";
          }

          if (remainingTime > 0) {
            remainingTime--;
            setTimeout(updateTimer, 1000);
          }
        }

        updateTimer();
      }

      // Bắt đầu đếm ngược từ 29 phút 10 giây (tổng cộng 1750 giây)
      window.onload = function () {
        startCountdown(65);
      };
    </script>
    <script src="js/script.js"></script>
    <script>
      document.querySelectorAll(".toggle-trans").forEach((button) => {
        button.addEventListener("click", (event) => {
          event.stopPropagation(); // Ngăn sự kiện lan ra ngoài
          document
            .querySelectorAll(".toggle-trans-container")
            .forEach((container) => {
              container.classList.toggle("hidden");
            });
        });
      });

      const audio = document.getElementById("audio");
      const playPauseBtn = document.getElementById("playPauseBtn");
      const progressBar = document.getElementById("progressBar");
      const timeDisplay = document.getElementById("timeDisplay");

      let isPlaying = false;

      // Toggle play/pause when clicking the icon
      playPauseBtn.addEventListener("click", () => {
        if (isPlaying) {
          audio.pause();
        } else {
          audio.play();
        }
      });

      // When audio plays
      audio.addEventListener("play", () => {
        isPlaying = true;
        playPauseBtn.src = "public/exam1/icons/pause-green.svg"; // Change icon
        progressBar.style.background = "blue"; // Change background color
      });

      // When audio pauses
      audio.addEventListener("pause", () => {
        isPlaying = false;
        playPauseBtn.src = "public/exam1/icons/play-orange.svg"; // Change icon
        progressBar.style.background = "orange"; // Change background color
      });

      // Update progress bar and time
      audio.addEventListener("timeupdate", () => {
        const progress = (audio.currentTime / audio.duration) * 100;
        progressBar.value = progress;

        // Update time display
        const minutes = Math.floor(audio.currentTime / 60);
        const seconds = Math.floor(audio.currentTime % 60);
        timeDisplay.textContent = `${String(minutes).padStart(2, "0")}:${String(
          seconds
        ).padStart(2, "0")}`;
      });

      // Allow seeking using the progress bar
      progressBar.addEventListener("input", (e) => {
        const seekTime = (e.target.value / 100) * audio.duration;
        audio.currentTime = seekTime;
      });
    </script>
    <script>
      document
        .querySelectorAll(".exam1-content9-sentence")
        .forEach((sentence) => {
          // Skip nếu có class 'result'
          if (sentence.classList.contains("result")) return;

          // Xử lý khi click vào các variants
          sentence
            .querySelectorAll(".exam1-content9-variant")
            .forEach((variant) => {
              variant.addEventListener("click", function () {
                // Nếu variant đã active => bỏ active
                if (this.classList.contains("active")) {
                  this.classList.remove("active");
                } else {
                  // Xóa active khỏi tất cả variants trong cùng câu
                  sentence
                    .querySelectorAll(".exam1-content9-variant")
                    .forEach((v) => v.classList.remove("active"));

                  // Thêm active vào variant được click
                  this.classList.add("active");
                }
              });
            });
        });
    </script>
  </body>
</html>
